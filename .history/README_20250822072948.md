# 🚀 ThucTapVietNienLuan - Ứng dụng Thương mại điện tử Camera

Ứng dụng web thương mại điện tử chuyên về máy ảnh và phụ kiện nhiếp ảnh, được xây dựng với React + Node.js + MongoDB.

## 📋 Mục lục

- [Tính năng](#-tính-năng)
- [Công nghệ sử dụng](#-công-nghệ-sử-dụng)
- [Cài đặt](#-cài-đặt)
- [Cấu hình Database](#-cấu-hình-database)
- [Chạy ứng dụng](#-chạy-ứng-dụng)
- [Cấu trúc dự án](#-cấu-trúc-dự-án)
- [API Endpoints](#-api-endpoints)
- [Tài khoản mặc định](#-tài-khoản-mặc-định)
- [Xử lý sự cố](#-xử-lý-sự-cố)

## ✨ Tính năng

### 👤 Người dùng
- Đăng ký/Đăng nhập tài khoản
- Xem danh sách sản phẩm
- Tìm kiếm và lọc sản phẩm
- Xem chi tiết sản phẩm
- Thêm vào giỏ hàng
- Quản lý thông tin cá nhân
- Xem lịch sử đơn hàng

### 🔐 Admin
- Quản lý sản phẩm (CRUD)
- Quản lý tài khoản người dùng
- Thống kê doanh thu và đơn hàng
- Dashboard quản trị

## 🛠 Công nghệ sử dụng

### Frontend
- **React 18** - Framework JavaScript
- **Ant Design** - UI Component Library
- **React Router** - Routing
- **Context API** - State Management
- **Vite** - Build Tool

### Backend
- **Node.js** - Runtime JavaScript
- **Express.js** - Web Framework
- **MongoDB** - Database
- **Mongoose** - ODM
- **bcryptjs** - Password Hashing
- **CORS** - Cross-Origin Resource Sharing

## 📦 Cài đặt

### 1. Clone dự án
```bash
git clone <repository-url>
cd ThucTapVietNienLuan
```

### 2. Cài đặt dependencies Frontend
```bash
npm install
```

### 3. Cài đặt dependencies Backend
```bash
cd backend
npm install
```

## 🗄 Cấu hình Database

### 1. Cài đặt MongoDB

#### Windows
1. Tải MongoDB Community Server từ [mongodb.com](https://www.mongodb.com/try/download/community)
2. Cài đặt với tùy chọn "Install MongoDB as a Service"
3. Khởi động MongoDB service:
```bash
# Kiểm tra service
Get-Service -Name "MongoDB"

# Khởi động nếu chưa chạy
Start-Service -Name "MongoDB"
```

#### macOS/Linux
```bash
# Với Homebrew (macOS)
brew tap mongodb/brew
brew install mongodb-community

# Khởi động MongoDB
brew services start mongodb-community
```

### 2. Cấu hình Backend
File `backend/config.env`:
```env
MONGODB_URI=mongodb://localhost:27017/Camera
PORT=5000
```

## 🚀 Chạy ứng dụng

### 1. Khởi động Backend
```bash
cd backend

# Chạy script setup database (chỉ chạy 1 lần đầu)
node setup-database.js

# Khởi động server
node server.js
```

**Kết quả mong đợi:**
```
Connected to MongoDB successfully!
Server is running on port 5000
```

### 2. Khởi động Frontend
```bash
# Mở terminal mới, quay về thư mục gốc
cd ..

# Khởi động React app
npm run dev
```

**Kết quả mong đợi:**
```
  VITE v5.x.x  ready in xxx ms

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
```

### 3. Truy cập ứng dụng
- **Frontend:** http://localhost:5173
- **Backend API:** http://localhost:5000

## 📁 Cấu trúc dự án

```
ThucTapVietNienLuan/
├── frontend/                 # React application
│   ├── src/
│   │   ├── components/      # Reusable components
│   │   ├── pages/          # Page components
│   │   ├── context/        # React Context
│   │   └── assets/         # Images, icons
│   ├── package.json
│   └── vite.config.js
├── backend/                  # Node.js server
│   ├── models/             # MongoDB schemas
│   ├── routes/             # API endpoints
│   ├── config.env          # Environment variables
│   ├── server.js           # Main server file
│   ├── setup-database.js   # Database initialization
│   └── package.json
└── README.md
```

## 🔌 API Endpoints

### Authentication
- `POST /api/taikhoan/login` - Đăng nhập
- `POST /api/taikhoan` - Đăng ký tài khoản mới

### Products
- `GET /api/products` - Lấy danh sách sản phẩm
- `GET /api/products/:id` - Lấy chi tiết sản phẩm
- `POST /api/admin/products` - Thêm sản phẩm mới (Admin)
- `PUT /api/admin/products/:id` - Cập nhật sản phẩm (Admin)
- `DELETE /api/admin/products/:id` - Xóa sản phẩm (Admin)

### Accounts
- `GET /api/taikhoan` - Lấy danh sách tài khoản (Admin)
- `PUT /api/taikhoan/:id` - Cập nhật tài khoản
- `DELETE /api/taikhoan/:id` - Xóa tài khoản (Admin)

### Dashboard
- `GET /api/dashboard/stats` - Thống kê tổng quan
- `GET /api/dashboard/revenue` - Thống kê doanh thu
- `GET /api/dashboard/top-products` - Sản phẩm bán chạy

## 🔑 Tài khoản mặc định

Sau khi chạy `setup-database.js`, hệ thống sẽ có:

### Admin Account
- **Username:** `admin`
- **Password:** `admin123`
- **Email:** `admin@example.com`
- **Vai trò:** `admin`

### Sample Products
- Canon EOS R5 - 85,000,000 VND
- Sony A7 IV - 45,000,000 VND  
- Nikon Z6 III - 55,000,000 VND

## 🚨 Xử lý sự cố

### 1. Backend không khởi động được

#### Lỗi: "Cannot find module"
```bash
cd backend
npm install
```

#### Lỗi: "EADDRINUSE: address already in use :::5000"
```bash
# Tìm process đang sử dụng port 5000
netstat -ano | findstr :5000

# Dừng process (thay PID bằng Process ID thực tế)
taskkill /PID <PID> /F
```

#### Lỗi: "MongoDB connection error"
```bash
# Kiểm tra MongoDB service
Get-Service -Name "MongoDB"

# Khởi động MongoDB nếu cần
Start-Service -Name "MongoDB"
```

### 2. Frontend không kết nối được Backend

#### Kiểm tra URL API
Đảm bảo tất cả API calls đều có prefix `/api`:
```javascript
// ❌ Sai
fetch('http://localhost:5000/taikhoan/login')

// ✅ Đúng  
fetch('http://localhost:5000/api/taikhoan/login')
```

#### Kiểm tra CORS
Backend đã có CORS middleware, nhưng nếu vẫn lỗi:
```javascript
// Trong backend/server.js
app.use(cors({
  origin: 'http://localhost:5173',
  credentials: true
}));
```

### 3. Database trống

#### Chạy lại setup database
```bash
cd backend
node setup-database.js
```

#### Kiểm tra kết nối MongoDB
```bash
# Kiểm tra database có tồn tại
mongosh --eval "use Camera; db.sanpham.find().count()"
```

### 4. Lỗi đăng nhập

#### Kiểm tra tài khoản tồn tại
```bash
# Test API đăng nhập
curl -X POST http://localhost:5000/api/taikhoan/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}'
```

#### Kiểm tra password hash
Model `TaiKhoan` sử dụng `bcryptjs` để hash password. Đảm bảo field name là `password` (không phải `matKhau`).

## 📱 Sử dụng ứng dụng

### 1. Đăng nhập Admin
1. Truy cập http://localhost:5173
2. Click "Đăng nhập/Đăng Ký"
3. Sử dụng tài khoản: `admin` / `admin123`
4. Sau khi đăng nhập, menu Admin sẽ xuất hiện

### 2. Quản lý sản phẩm
1. Đăng nhập với tài khoản Admin
2. Vào menu "Quản lý sản phẩm"
3. Thêm/Sửa/Xóa sản phẩm

### 3. Quản lý tài khoản
1. Đăng nhập với tài khoản Admin  
2. Vào menu "Quản lý tài khoản"
3. Quản lý vai trò và trạng thái người dùng

## 🔧 Development

### Hot Reload
- **Frontend:** Tự động reload khi thay đổi code
- **Backend:** Cần restart server khi thay đổi

### Environment Variables
Tạo file `.env` trong thư mục gốc:
```env
VITE_API_BASE_URL=http://localhost:5000/api
```

### Database Schema
Xem file `backend/models/` để hiểu cấu trúc database.

## 📞 Hỗ trợ

Nếu gặp vấn đề:
1. Kiểm tra console browser (F12)
2. Kiểm tra terminal backend
3. Kiểm tra MongoDB connection
4. Đảm bảo tất cả services đang chạy

---

**Lưu ý:** Đây là dự án thực tập, chỉ sử dụng cho mục đích học tập và phát triển.
